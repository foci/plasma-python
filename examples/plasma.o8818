all signals (determines which signals are downloaded and preprocessed):
[Radiated Power Core, Input Beam Torque, Input Power (beam for d3d), q95 safety factor, plasma current, stored energy, Locked mode amplitude, Rogowsky current2, Rogowsky current3, Rogowsky current1, plasma current error, Plasma density, Radiated Power Edge, plasma current target, Normalized Beta, plasma current direction, Electron density profile, Electron temperature profile, internal inductance, stored energy time derivative, Radiated Power]
Selected signals (determines which signals training is run on):
[Rogowsky current1]
[0] importing Keras
{'callbacks': {'list': ['earlystop'],
               'metrics': ['val_loss', 'val_roc', 'train_loss'],
               'mode': 'max',
               'monitor': 'val_roc',
               'patience': 5,
               'write_grads': False},
 'data': {'T_max': 1000.0,
          'T_min_warn': 30,
          'T_warning': 1.024,
          'augment_during_training': False,
          'augmentation_mode': 'none',
          'bleed_in': 0,
          'bleed_in_equalize_sets': True,
          'bleed_in_remove_from_test': True,
          'bleed_in_repeat_fac': 1,
          'current_end_thresh': 10000,
          'current_index': 0,
          'current_thresh': 750000,
          'cut_shot_ends': True,
          'dt': 0.001,
          'equalize_classes': False,
          'floatx': 'float32',
          'norm_stat_range': 100.0,
          'normalizer': 'var',
          'plotting': False,
          'positive_example_penalty': 1.0,
          'recompute': False,
          'recompute_normalization': False,
          'signal_to_augment': 'None',
          'target': <class 'plasma.models.targets.HingeTarget'>,
          'use_shots': 200000,
          'window_decay': 2,
          'window_size': 10},
 'env': {'name': 'frnn', 'type': 'anaconda'},
 'fs_path': '/work/00004/michoski/maverick2',
 'model': {'backend': 'tensorflow',
           'clipnorm': 10.0,
           'dense_regularization': 0.001,
           'dense_size': 128,
           'dropout_prob': 0.1,
           'extra_dense_input': False,
           'ignore_timesteps': 100,
           'length': 128,
           'loss_scale_factor': 1.0,
           'lr': 2e-05,
           'lr_decay': 0.97,
           'num_conv_filters': 128,
           'num_conv_layers': 3,
           'optimizer': 'adam',
           'pool_size': 2,
           'pred_batch_size': 128,
           'pred_length': 200,
           'regularization': 0.001,
           'return_sequences': True,
           'rnn_layers': 2,
           'rnn_size': 200,
           'rnn_type': 'LSTM',
           'shallow': False,
           'shallow_model': {'C': 1.0,
                             'final_hidden_layer_size': 10,
                             'kernel': 'rbf',
                             'learning_rate': 0.1,
                             'learning_rate_mlp': 0.0001,
                             'max_depth': 3,
                             'mlp_regularization': 0.0001,
                             'n_estimators': 100,
                             'num_hidden_layers': 3,
                             'num_samples': 1000000,
                             'scale_pos_weight': 10.0,
                             'skip_train': False,
                             'type': 'xgboost'},
           'size_conv_filters': 3,
           'skip': 1,
           'stateful': True,
           'use_batch_norm': False,
           'use_bidirectional': False,
           'warmup_steps': 0},
 'num_gpus': 1,
 'paths': {'all_machines': [d3d],
           'all_signals': [Radiated Power Core,
                           Input Beam Torque,
                           Input Power (beam for d3d),
                           q95 safety factor,
                           plasma current,
                           stored energy,
                           Locked mode amplitude,
                           Rogowsky current2,
                           Rogowsky current3,
                           Rogowsky current1,
                           plasma current error,
                           Plasma density,
                           Radiated Power Edge,
                           plasma current target,
                           Normalized Beta,
                           plasma current direction,
                           internal inductance,
                           stored energy time derivative,
                           Radiated Power,
                           Electron density profile,
                           Electron temperature profile],
           'all_signals_dict': {'betan': Normalized Beta,
                                'dens': Plasma density,
                                'edens_profile': Electron density profile,
                                'energy': stored energy,
                                'energydt': stored energy time derivative,
                                'etemp_profile': Electron temperature profile,
                                'ip': plasma current,
                                'ipdirect': plasma current direction,
                                'iperr': plasma current error,
                                'iptarget': plasma current target,
                                'li': internal inductance,
                                'lm': Locked mode amplitude,
                                'pin': Input Power (beam for d3d),
                                'pradcore': Radiated Power Core,
                                'pradedge': Radiated Power Edge,
                                'pradtot': Radiated Power,
                                'q95': q95 safety factor,
                                'rl01': Rogowsky current1,
                                'rl02': Rogowsky current2,
                                'rl03': Rogowsky current3,
                                'torquein': Input Beam Torque},
           'base_path': '/work/00004/michoski/maverick2',
           'csvlog_save_path': '/work/00004/michoski/maverick2/csv_logs/',
           'data': 'd3d_data_cem',
           'executable': 'mpi_learn.py',
           'global_normalizer_path': '/work/00004/michoski/maverick2/normalization/normalization_signal_group_82673926425604747807641017103632307575.npz',
           'model_save_path': '/work/00004/michoski/maverick2/model_checkpoints/',
           'normalizer_path': '/work/00004/michoski/maverick2/normalization/normalization_signal_group_82673926425604747807641017103632307575.npz',
           'output_path': '/work/00004/michoski/maverick2',
           'processed_prepath': '/work/00004/michoski/maverick2/processed_shots/signal_group_82673926425604747807641017103632307575/',
           'results_prepath': '/work/00004/michoski/maverick2/results/',
           'saved_shotlist_path': '/work/00004/michoski/maverick2/processed_shotlists/d3d_data_cem/shot_lists_signal_group_82673926425604747807641017103632307575.npz',
           'shallow_executable': 'learn.py',
           'shot_files': [machine: d3d
d3d data since shot 125500],
           'shot_files_all': [machine: d3d
d3d data since shot 125500],
           'shot_files_test': [],
           'shot_list_dir': '/work/00004/michoski/maverick2/shot_lists/d3d/',
           'signal_prepath': '/work/00004/michoski/maverick2/../../../05447/merlo/maverick/plasma_python/signal_data_new/',
           'specific_signals': ['rl01'],
           'tensorboard_save_path': '/work/00004/michoski/maverick2/Graph/',
           'use_signals': [Rogowsky current1],
           'use_signals_dict': {'betan': Normalized Beta,
                                'dens': Plasma density,
                                'edens_profile': Electron density profile,
                                'energy': stored energy,
                                'etemp_profile': Electron temperature profile,
                                'ip': plasma current,
                                'ipdirect': plasma current direction,
                                'iperr': plasma current error,
                                'iptarget': plasma current target,
                                'li': internal inductance,
                                'lm': Locked mode amplitude,
                                'pin': Input Power (beam for d3d),
                                'pradcore': Radiated Power Core,
                                'pradedge': Radiated Power Edge,
                                'q95': q95 safety factor,
                                'rl01': Rogowsky current1,
                                'rl02': Rogowsky current2,
                                'rl03': Rogowsky current3,
                                'torquein': Input Beam Torque}},
 'target': 'hinge',
 'training': {'as_array_of_shots': True,
              'batch_generator_warmup_steps': 0,
              'batch_size': 128,
              'data_parallel': False,
              'hyperparam_tuning': False,
              'max_patch_length': 100000,
              'num_batches_minimum': 200,
              'num_epochs': 20,
              'num_shots_at_once': 200,
              'ranking_difficulty_fac': 1.0,
              'shuffle_training': True,
              'train_frac': 0.75,
              'use_mock_data': False,
              'validation_frac': 0.33},
 'user_name': 'michoski'}
{'callbacks': {'list': ['earlystop'],
               'metrics': ['val_loss', 'val_roc', 'train_loss'],
               'mode': 'max',
               'monitor': 'val_roc',
               'patience': 5,
               'write_grads': False},
 'data': {'T_max': 1000.0,
          'T_min_warn': 30,
          'T_warning': 1.024,
          'augment_during_training': False,
          'augmentation_mode': 'none',
          'bleed_in': 0,
          'bleed_in_equalize_sets': True,
          'bleed_in_remove_from_test': True,
          'bleed_in_repeat_fac': 1,
          'current_end_thresh': 10000,
          'current_index': 0,
          'current_thresh': 750000,
          'cut_shot_ends': True,
          'dt': 0.001,
          'equalize_classes': False,
          'floatx': 'float32',
          'norm_stat_range': 100.0,
          'normalizer': 'var',
          'plotting': False,
          'positive_example_penalty': 1.0,
          'recompute': False,
          'recompute_normalization': False,
          'signal_to_augment': 'None',
          'target': <class 'plasma.models.targets.HingeTarget'>,
          'use_shots': 200000,
          'window_decay': 2,
          'window_size': 10},
 'env': {'name': 'frnn', 'type': 'anaconda'},
 'fs_path': '/work/00004/michoski/maverick2',
 'model': {'backend': 'tensorflow',
           'clipnorm': 10.0,
           'dense_regularization': 0.001,
           'dense_size': 128,
           'dropout_prob': 0.1,
           'extra_dense_input': False,
           'ignore_timesteps': 100,
           'length': 128,
           'loss_scale_factor': 1.0,
           'lr': 2e-05,
           'lr_decay': 0.97,
           'num_conv_filters': 128,
           'num_conv_layers': 3,
           'optimizer': 'adam',
           'pool_size': 2,
           'pred_batch_size': 128,
           'pred_length': 200,
           'regularization': 0.001,
           'return_sequences': True,
           'rnn_layers': 2,
           'rnn_size': 200,
           'rnn_type': 'LSTM',
           'shallow': False,
           'shallow_model': {'C': 1.0,
                             'final_hidden_layer_size': 10,
                             'kernel': 'rbf',
                             'learning_rate': 0.1,
                             'learning_rate_mlp': 0.0001,
                             'max_depth': 3,
                             'mlp_regularization': 0.0001,
                             'n_estimators': 100,
                             'num_hidden_layers': 3,
                             'num_samples': 1000000,
                             'scale_pos_weight': 10.0,
                             'skip_train': False,
                             'type': 'xgboost'},
           'size_conv_filters': 3,
           'skip': 1,
           'stateful': True,
           'use_batch_norm': False,
           'use_bidirectional': False,
           'warmup_steps': 0},
 'num_gpus': 1,
 'paths': {'all_machines': [d3d],
           'all_signals': [Radiated Power Core,
                           Input Beam Torque,
                           Input Power (beam for d3d),
                           q95 safety factor,
                           plasma current,
                           stored energy,
                           Locked mode amplitude,
                           Rogowsky current2,
                           Rogowsky current3,
                           Rogowsky current1,
                           plasma current error,
                           Plasma density,
                           Radiated Power Edge,
                           plasma current target,
                           Normalized Beta,
                           plasma current direction,
                           internal inductance,
                           stored energy time derivative,
                           Radiated Power,
                           Electron density profile,
                           Electron temperature profile],
           'all_signals_dict': {'betan': Normalized Beta,
                                'dens': Plasma density,
                                'edens_profile': Electron density profile,
                                'energy': stored energy,
                                'energydt': stored energy time derivative,
                                'etemp_profile': Electron temperature profile,
                                'ip': plasma current,
                                'ipdirect': plasma current direction,
                                'iperr': plasma current error,
                                'iptarget': plasma current target,
                                'li': internal inductance,
                                'lm': Locked mode amplitude,
                                'pin': Input Power (beam for d3d),
                                'pradcore': Radiated Power Core,
                                'pradedge': Radiated Power Edge,
                                'pradtot': Radiated Power,
                                'q95': q95 safety factor,
                                'rl01': Rogowsky current1,
                                'rl02': Rogowsky current2,
                                'rl03': Rogowsky current3,
                                'torquein': Input Beam Torque},
           'base_path': '/work/00004/michoski/maverick2',
           'csvlog_save_path': '/work/00004/michoski/maverick2/csv_logs/',
           'data': 'd3d_data_cem',
           'executable': 'mpi_learn.py',
           'global_normalizer_path': '/work/00004/michoski/maverick2/normalization/normalization_signal_group_82673926425604747807641017103632307575.npz',
           'model_save_path': '/work/00004/michoski/maverick2/model_checkpoints/',
           'normalizer_path': '/work/00004/michoski/maverick2/normalization/normalization_signal_group_82673926425604747807641017103632307575.npz',
           'output_path': '/work/00004/michoski/maverick2',
           'processed_prepath': '/work/00004/michoski/maverick2/processed_shots/signal_group_82673926425604747807641017103632307575/',
           'results_prepath': '/work/00004/michoski/maverick2/results/',
           'saved_shotlist_path': '/work/00004/michoski/maverick2/processed_shotlists/d3d_data_cem/shot_lists_signal_group_82673926425604747807641017103632307575.npz',
           'shallow_executable': 'learn.py',
           'shot_files': [machine: d3d
d3d data since shot 125500],
           'shot_files_all': [machine: d3d
d3d data since shot 125500],
           'shot_files_test': [],
           'shot_list_dir': '/work/00004/michoski/maverick2/shot_lists/d3d/',
           'signal_prepath': '/work/00004/michoski/maverick2/../../../05447/merlo/maverick/plasma_python/signal_data_new/',
           'specific_signals': ['rl01'],
           'tensorboard_save_path': '/work/00004/michoski/maverick2/Graph/',
           'use_signals': [Rogowsky current1],
           'use_signals_dict': {'betan': Normalized Beta,
                                'dens': Plasma density,
                                'edens_profile': Electron density profile,
                                'energy': stored energy,
                                'etemp_profile': Electron temperature profile,
                                'ip': plasma current,
                                'ipdirect': plasma current direction,
                                'iperr': plasma current error,
                                'iptarget': plasma current target,
                                'li': internal inductance,
                                'lm': Locked mode amplitude,
                                'pin': Input Power (beam for d3d),
                                'pradcore': Radiated Power Core,
                                'pradedge': Radiated Power Edge,
                                'q95': q95 safety factor,
                                'rl01': Rogowsky current1,
                                'rl02': Rogowsky current2,
                                'rl03': Rogowsky current3,
                                'torquein': Input Beam Torque}},
 'target': 'hinge',
 'training': {'as_array_of_shots': True,
              'batch_generator_warmup_steps': 0,
              'batch_size': 128,
              'data_parallel': False,
              'hyperparam_tuning': False,
              'max_patch_length': 100000,
              'num_batches_minimum': 200,
              'num_epochs': 20,
              'num_shots_at_once': 200,
              'ranking_difficulty_fac': 1.0,
              'shuffle_training': True,
              'train_frac': 0.75,
              'use_mock_data': False,
              'validation_frac': 0.33},
 'user_name': 'michoski'}
shots already processed.
validate: 113 shots, 36 disruptive
training: 232 shots, 83 disruptive
testing: 115 shots, 36 disruptive
...done
shots already processed.
validate: 113 shots, 36 disruptive
training: 232 shots, 83 disruptive
testing: 115 shots, 36 disruptive
...done
normalizationshots_picked = 2002
Machine d3d:
loaded normalization data from {d3d: 460} shots ( {d3d: 155} disruptive )
Machine: d3d:
Var Normalizer.
stds: [  5.11111857e-04   1.84343181e+00   2.49626526e+03   1.15679182e+00
   3.25122196e-01   2.87642659e+05   1.33205591e+00   1.63381975e+05
   1.62125293e+05   1.62553205e+05   3.40087061e-02   1.12796648e+00
   6.22083277e-04   3.35996240e-01   7.51601104e-01   0.00000000e+00
   1.79971509e-01   1.40767138e+00   1.12724054e+00]

...done
loading from epoch 4
